(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["zh_zbkq-pages-poster_coup-index"],{"28f0":function(e,t,n){"use strict";n.r(t);var a=n("a9c8"),o=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=o.a},"3cc1":function(e,t,n){"use strict";n.r(t);var a=n("7b4a"),o=n("28f0");for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("7974");var s,c=n("f0c5"),l=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,"163f313e",null,!1,a["a"],s);t["default"]=l.exports},"6f3c":function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,"uni-page-body[data-v-163f313e]{background-color:#edeef2}.poste_box[data-v-163f313e]{width:85%;margin:auto;margin-top:%?50?%;background-color:#fff;border:%?1?% solid #ddd;-webkit-box-shadow:0 0 10px 5px #d8d7dd;box-shadow:0 0 10px 5px #d8d7dd}.savePoste[data-v-163f313e]{background-color:#ff8427;width:90%;margin-left:auto;margin-right:auto;margin-top:%?30?%;color:#fff}.saveTitle[data-v-163f313e]{font-size:%?25?%;color:#666;width:90%;margin-left:auto;margin-right:auto;margin-top:%?20?%;text-align:center}.tips[data-v-163f313e]{margin-top:%?50?%;text-align:center}.tips .saveBtn[data-v-163f313e]{background:#f66;border-radius:%?30?%;padding:%?12?% %?60?%;color:#fff;font-size:%?28?%}.tips .info[data-v-163f313e]{opacity:.8;font-size:x-small;margin-top:%?25?%}body.?%PAGE?%[data-v-163f313e]{background-color:#edeef2}",""]),e.exports=t},7974:function(e,t,n){"use strict";var a=n("c6d4"),o=n.n(a);o.a},"7b4a":function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("v-uni-view",{staticClass:"poste_box",attrs:{id:e.canvasDivID}},[e.showloading?n("v-uni-image",{staticClass:"qrcodeimg",style:"width:"+.85*e.sys.windowWidth+"px;height:"+.85*e.sys.windowWidth*6/9+"px;",attrs:{src:"https://temp-customs-1251903635.cos.ap-chengdu.myqcloud.com/Spb2u.net%20NewZealand/spb2u%20wxapp/zaozao%20kuaigou/new_wxapp/Ball%2BCross%2BLoading%2BImage%2BGif.gif"}}):e._e(),e.showloading?e._e():n("v-uni-canvas",{style:"width:100%;height:"+.85*e.sys.windowWidth+"px;",attrs:{"canvas-id":e.canvasID}})],1),n("v-uni-view",{staticClass:"tips"},[n("v-uni-text",{staticClass:"saveBtn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.saveShareImg.apply(void 0,arguments)}}},[e._v("保存图片 Sava Picture")]),n("v-uni-view",{staticClass:"info"},[e._v("保存到相册可在朋友圈分享海报")])],1)],1)},i=[]},a9c8:function(e,t,n){"use strict";var a;n("cb29"),n("c975"),n("fb6a"),n("ac1f"),n("5319"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={},i={data:function(){return{showloading:!0,canvasID:"mycanvas"+(new Date).getTime(),canvasDivID:"canDiv"+(new Date).getTime(),sys:{}}},components:{},props:{},onLoad:function(){a=this;var e=this.getOpenerEventChannel();e.on("acceptDataFromOfflinePay",(function(e){o.coup_name=e.data.coup_name,o.address=e.data.address,o.end_time=e.data.end_time,o.md_name=e.data.md_name,o.name=e.data.name,e.data.vip&&(o.vip="../../../static/img/VIP1.png"),o.qrcode=e.data.qrcode,o.sysl=e.data.sysl.replace(/\s+/g,""),o.md_logo="https://we-pon-com-1251903635.coshk.myqcloud.com/"+e.data.md_logo,o.name.indexOf("广告券 Ads")>-1&&(o["type"]="ad",o["typeColor"]="#2ec100"),o.name.indexOf("折价券 Disc")>-1&&(o["type"]="折",o["typeColor"]="#ef2929"),o.name.indexOf("就餐券 Meal")>-1&&(o["type"]="餐",o["typeColor"]="crimson"),o.name.indexOf("代金券 Cash")>-1&&(o["type"]="金",o["typeColor"]="#ffa52a")})),uni.getSystemInfo({success:function(e){a.sys=e,a.getBgImgDown()}})},methods:{getBgImgDown:function(){a.getQrCode("../../../static/img/800_x_800.jpg")},getQrCode:function(e){uni.downloadFile({url:o.qrcode,success:function(t){if(200===t.statusCode){var n=t.tempFilePath;a.getMDlogo(e,n)}else uni.showToast({title:"二维码下载失败！",icon:"none",duration:2e3,success:function(){var t="";a.getMDlogo(e,t)}})},fail:function(e){uni.showModal({title:"提示",content:JSON.stringify(e)+"",success:function(e){e.confirm?console.log("用户点击确定"):e.cancel&&console.log("用户点击取消")}})}})},getMDlogo:function(e,t){var n=this;uni.downloadFile({url:o.md_logo,success:function(a){if(200===a.statusCode){var o=a.tempFilePath;n.sharePosteCanvas(e,t,o)}else uni.showToast({title:"二维码下载失败！",icon:"none",duration:2e3,success:function(){}})},fail:function(e){uni.showModal({title:"提示",content:JSON.stringify(e)+"",success:function(e){e.confirm?console.log("用户点击确定"):e.cancel&&console.log("用户点击取消")}})}})},sharePosteCanvas:function(e,t,n){var a=this,i=uni.createCanvasContext(a.canvasID),s="";uni.createSelectorQuery().select("#"+a.canvasDivID).boundingClientRect((function(c){c.height,c.right;s=1*c.width;var l=.38*s;i.setFillStyle("#fff"),i.fillRect(0,0,c.width,c.width);var r=-5,d=500*s/900;if(e&&(i.drawImage(e,0,0,s,d),i.setFontSize(14),i.setFillStyle("#fff"),i.setTextAlign("left")),o.TagText){i.setFontSize(18),i.fillText(o.TagText,l+100,d-15);i.measureText(o.TagText);i.stroke(),i.fill()}o.md_name&&(o.md_name.length>18&&(o.md_name=o.md_name.substr(0,17)+"..."),i.setTextAlign("left"),i.setFillStyle("#000000"),i.setFontSize(18),i.fillText(o.md_name,l,.67*s)),o.coup_name&&(getApp().globalData.utilmy.strlen(o.coup_name)>7&&(o.coup_name=o.coup_name.substr(0,7)+"..."),i.setTextAlign("left"),i.setFillStyle("#f44"),i.setFontSize(29),i.fillText(o.coup_name,l,.78*s)),o.end_time&&(i.setFontSize(12),i.setFillStyle("#000"),i.setTextAlign("left"),i.fillText(o.end_time,l,.86*s)),i.setTextAlign("left"),i.setFontSize(12),i.textBaseline="bottom",i.fillText("长按二维码 即可 ",l,.932*s),i.setTextAlign("left"),i.setFontSize(12),i.setFillStyle("red"),i.textBaseline="bottom",i.fillText("导航 收藏 核销",1.75*l,.932*s),o.address,o.sysl,n&&(i.drawImage(n,.03*s,.624*s,.31*s,.31*s),i.setFontSize(10),i.setFillStyle("#000"),i.fillText("微信扫码或长按识别",l+160,s+195+r)),i.setStrokeStyle("whitesmoke"),i.lineJoin="round",i.lineWidth=2,i.strokeRect(.029*s,.619*s,.315*s,.315*s),o.vip&&i.drawImage(o.vip,2.14*l,.79*s,.11*s,.11*s),t&&(i.drawImage(t,.177*s,.247*s,.188*s,.188*s),i.setFontSize(10),i.setFillStyle("#000"));var u=666;setTimeout((function(){a.showloading=!1}),u),i.draw(),i.restore()})).exec()},textByteLength:function(e,t){for(var n=0,a=1,o=0,i=[],s=0;s<e.length;s++)e.charCodeAt(s)>255?(n+=2,n>a*t&&(n++,i.push(e.slice(o,s)),o=s,a++)):(n++,n>a*t&&(i.push(e.slice(o,s)),o=s,a++));return i.push(e.slice(o,e.length)),[n,i,a]},saveShareImg:function(){uni.showLoading({title:"拼命保存中..."});var e=this;uni.canvasToTempFilePath({canvasId:e.canvasID,success:function(e){var t=e.tempFilePath;uni.saveImageToPhotosAlbum({filePath:t,success:function(e){uni.hideLoading(),uni.showModal({content:"图片已保存到相册，赶紧晒一下吧~Picture Save Success!",showCancel:!1,confirmText:"好的",confirmColor:"#333",success:function(e){e.confirm},fail:function(e){}})},fail:function(e){uni.showToast({title:e.errMsg,icon:"none",duration:2e3})}})}})}}};t.default=i},c6d4:function(e,t,n){var a=n("6f3c");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var o=n("4f06").default;o("fef83854",a,!0,{sourceMap:!1,shadowMode:!1})},cb29:function(e,t,n){var a=n("23e7"),o=n("81d5"),i=n("44d2");a({target:"Array",proto:!0},{fill:o}),i("fill")}}]);