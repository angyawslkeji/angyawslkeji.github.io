(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["zh_zbkq-pages-poster-index"],{"06c5":function(t,e,n){"use strict";n("a630"),n("fb6a"),n("d3b7"),n("25f0"),n("3ca3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var a=o(n("6b75"));function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(t){if("string"===typeof t)return(0,a.default)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,a.default)(t,e):void 0}}},"09f0":function(t,e,n){"use strict";function a(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],a=!0,o=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(a=(r=s.next()).done);a=!0)if(n.push(r.value),e&&n.length===e)break}catch(u){o=!0,i=u}finally{try{a||null==s["return"]||s["return"]()}finally{if(o)throw i}}return n}}n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},"0d21":function(t,e,n){"use strict";function a(t){if(Array.isArray(t))return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},"356d":function(t,e,n){"use strict";var a=n("dbc1"),o=n.n(a);o.a},3835:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var a=s(n("0d21")),o=s(n("09f0")),i=s(n("06c5")),r=s(n("3d8c"));function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return(0,a.default)(t)||(0,o.default)(t,e)||(0,i.default)(t,e)||(0,r.default)()}},"3d8c":function(t,e,n){"use strict";function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},5373:function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("v-uni-view",{staticClass:"poste_box",attrs:{id:"canvas-container"}},[n("v-uni-canvas",{style:"width:100%;height:"+.85*t.sys.windowWidth+"px;",attrs:{"canvas-id":"myCanvas"}})],1),n("v-uni-view",{staticClass:"tips"},[n("v-uni-text",{staticClass:"saveBtn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveShareImg.apply(void 0,arguments)}}},[t._v("保存图片 Sava Picture")]),n("v-uni-view",{staticClass:"info"},[t._v("保存到相册可在朋友圈分享海报")])],1)],1)},i=[]},"61d2":function(t,e,n){"use strict";n.r(e);var a=n("c9c8"),o=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},"6b75":function(t,e,n){"use strict";function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},"6c7b":function(t,e,n){"use strict";n.r(e);var a=n("5373"),o=n("61d2");for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("356d");var r,s=n("f0c5"),u=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"842b25b6",null,!1,a["a"],r);e["default"]=u.exports},b97c:function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,"uni-page-body[data-v-842b25b6]{background-color:#edeef2}.poste_box[data-v-842b25b6]{width:85%;margin:auto;margin-top:%?50?%;background-color:#fff;border:%?1?% solid #ddd;box-shadow:0 0 10px 5px #d8d7dd}.savePoste[data-v-842b25b6]{background-color:#ff8427;width:90%;margin-left:auto;margin-right:auto;margin-top:%?30?%;color:#fff}.saveTitle[data-v-842b25b6]{font-size:%?25?%;color:#666;width:90%;margin-left:auto;margin-right:auto;margin-top:%?20?%;text-align:center}.tips[data-v-842b25b6]{margin-top:%?50?%;text-align:center}.tips .saveBtn[data-v-842b25b6]{background:#f66;border-radius:%?30?%;padding:%?12?% %?60?%;color:#fff;font-size:%?28?%}.tips .info[data-v-842b25b6]{opacity:.8;font-size:x-small;margin-top:%?25?%}body.?%PAGE?%[data-v-842b25b6]{background-color:#edeef2}",""]),t.exports=e},c9c8:function(t,e,n){"use strict";var a=n("4ea4");n("cb29"),n("fb6a"),n("ac1f"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,i=a(n("3835")),r={data:function(){return{cardInfo:{avater:"https://temp-customs-1251903635.cos.ap-chengdu.myqcloud.com/Spb2u.net%20NewZealand/spb2u%20wxapp/zaozao%20kuaigou/new_wxapp/shangjia_beijing.png",qrCode:"https://ihogo-1251903635.file.myqcloud.com/qin/ä½å/qrCode/mininote.jpg",TagText:"",Name:"",Position:"程序员鼓励师乌拉",Mobile:"",price:""},sys:{}}},components:{},props:{},onLoad:function(){o=this;var t=this.getOpenerEventChannel();t.on("acceptDataFromOfflinePay",(function(t){o.cardInfo.Name=t.data.link_name,o.cardInfo.Mobile=t.data.address,o.cardInfo.Position=t.data.link_tel,o.cardInfo.price=t.data.md_name,o.cardInfo.qrCode=t.data.logos,o.cardInfo.md_logo="https://we-pon-com-1251903635.coshk.myqcloud.com/"+t.data.md_logo})),uni.getSystemInfo({success:function(t){o.sys=t,o.getAvaterInfo()}})},methods:{getAvaterInfo:function(){uni.showLoading({title:"生成中...",mask:!0});var t=this;uni.downloadFile({url:t.cardInfo.avater,success:function(e){if(uni.hideLoading(),200===e.statusCode){var n=e.tempFilePath;t.getQrCode(n)}else uni.showToast({title:"头像下载失败！",icon:"none",duration:2e3,success:function(){var e="";t.getQrCode(e)}})}})},getQrCode:function(t){uni.showLoading({title:"生成中...",mask:!0});var e=this;uni.downloadFile({url:e.cardInfo.qrCode,success:function(n){if(uni.hideLoading(),200===n.statusCode){var a=n.tempFilePath;e.getMDlogo(t,a)}else uni.showToast({title:"二维码下载失败！",icon:"none",duration:2e3,success:function(){var n="";e.getMDlogo(t,n)}})}})},getMDlogo:function(t,e){uni.showLoading({title:"生成中...",mask:!0});var n=this;uni.downloadFile({url:n.cardInfo.md_logo,success:function(a){if(uni.hideLoading(),200===a.statusCode){var o=a.tempFilePath;n.sharePosteCanvas(t,e,o)}else uni.showToast({title:"二维码下载失败！",icon:"none",duration:2e3,success:function(){}})}})},sharePosteCanvas:function(t,e,n){uni.showLoading({title:"生成中...",mask:!0});var a=this,o=a.cardInfo,r=uni.createCanvasContext("myCanvas"),s="";uni.createSelectorQuery().select("#canvas-container").boundingClientRect((function(u){var c=23,l=u.height;u.right;s=1*u.width;var d=15;r.setFillStyle("#fff"),r.fillRect(0,0,u.width,l);var f=5,v=500*s/900;if(t&&(r.drawImage(t,d-15,0,s,v),r.setFontSize(14),r.setFillStyle("#fff"),r.setTextAlign("left")),o.TagText){r.setFontSize(18),r.fillText(o.TagText,d+100,v-15);r.measureText(o.TagText);r.stroke(),r.fill()}if(o.Name&&getApp().globalData.utilmy.strlen(o.price)<30&&(r.setFontSize(14),r.setFillStyle("#000"),r.setTextAlign("left"),r.fillText(o.Name,d,v+60+f)),o.Position&&(r.setFontSize(12),r.setFillStyle("#666"),r.setTextAlign("left"),r.fillText(o.Position,d,v+85+f)),o.Mobile){var g=a.textByteLength(o.Mobile,28),h=(0,i.default)(g,3),p=(h[0],h[1]);h[2];r.setTextAlign("left"),r.setFontSize(12),r.setFillStyle("#666");for(var b=22,m=0;m<p.length;m++)r.fillText(p[m],d,v+105+f+b*m)}if(o.price){var y=a.textByteLength(o.price,c),w=(0,i.default)(y,3),x=(w[0],w[1]);w[2];r.setTextAlign("left"),r.setFillStyle("#000000"),r.setFontSize(20);for(var _=22,T=0;T<x.length;T++)r.fillText(x[T],d,v+35+f+_*T)}n&&(r.drawImage(n,.67*s,.6*s,.3*s,.3*s),r.setFontSize(10),r.setFillStyle("#000"),r.fillText("微信扫码或长按识别",d+160,s+195+f)),e&&(r.drawImage(e,.63*s,.19*s,.195*s,.195*s),r.setFontSize(10),r.setFillStyle("#000"))})).exec(),setTimeout((function(){r.draw(),uni.hideLoading()}),1e3)},textByteLength:function(t,e){for(var n=0,a=1,o=0,i=[],r=0;r<t.length;r++)t.charCodeAt(r)>255?(n+=2,n>a*e&&(n++,i.push(t.slice(o,r)),o=r,a++)):(n++,n>a*e&&(i.push(t.slice(o,r)),o=r,a++));return i.push(t.slice(o,t.length)),[n,i,a]},saveShareImg:function(){uni.showLoading({title:"正在保存",mask:!0}),setTimeout((function(){uni.canvasToTempFilePath({canvasId:"myCanvas",success:function(t){uni.hideLoading();var e=t.tempFilePath;uni.saveImageToPhotosAlbum({filePath:e,success:function(t){uni.showModal({content:"图片已保存到相册，赶紧晒一下吧~Picture Save Success!",showCancel:!1,confirmText:"好的",confirmColor:"#333",success:function(t){t.confirm},fail:function(t){}})},fail:function(t){uni.showToast({title:t.errMsg,icon:"none",duration:2e3})}})}})}),1e3)}}};e.default=r},cb29:function(t,e,n){var a=n("23e7"),o=n("81d5"),i=n("44d2");a({target:"Array",proto:!0},{fill:o}),i("fill")},dbc1:function(t,e,n){var a=n("b97c");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=n("4f06").default;o("41e99d54",a,!0,{sourceMap:!1,shadowMode:!1})}}]);